<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      
        <title>“感知红色广州”——广州市红旅景点情感分析系统</title>
      
      <link href="/2023/10/09/projects/%E2%80%9C%E6%84%9F%E7%9F%A5%E7%BA%A2%E8%89%B2%E5%B9%BF%E5%B7%9E%E2%80%9D%E2%80%94%E2%80%94%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%BA%A2%E6%97%85%E6%99%AF%E7%82%B9%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/"/>
      <url>/2023/10/09/projects/%E2%80%9C%E6%84%9F%E7%9F%A5%E7%BA%A2%E8%89%B2%E5%B9%BF%E5%B7%9E%E2%80%9D%E2%80%94%E2%80%94%E5%B9%BF%E5%B7%9E%E5%B8%82%E7%BA%A2%E6%97%85%E6%99%AF%E7%82%B9%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p>ESRI2023——“感知红色广州”——广州市红旅景点情感分析系统</p><h2 id="1-项目背景"><a href="#1-项目背景" class="headerlink" title="1.项目背景"></a>1.项目背景</h2><p>近年来，广州市政府愈发注重对红色资源的保护，在红色文化资源保护利用方面取得了不少成绩。根据中共广州市委党史研究室的普查结果显示, 广州市党史旧 (遗) 址现共有190处。依托全国文物普查和广州市第五次文物普查成果，当中知名度比较高、保护级别比较高的广州红色史迹文保单位共25处。当前，日益增多的游客通过互联网获取或反馈相关地点的旅游信息,“利用网络相互分享旅途体验或感受,从而使得有关旅游的大量舆论信息在网络平台上得以有效地交汇”。</p><p>因此，本项目聚焦于广州市红色旅游景点，以互联网评论为主要数据源之一，全面了解红色旅游景点的分布特征，厘清红色文化资源。通过情感分析从中微观层面对广州市红色旅游景点进行评价，为进一步保护红色旅游景点和因地制宜开发提供更加具有实践性的建议。</p><h2 id="2-项目简介"><a href="#2-项目简介" class="headerlink" title="2.项目简介"></a>2.项目简介</h2><p>  针对广州市内的红色旅游景点，本项目从地理空间、游客感知意象的角度出发，利用地理信息系统空间分析技术，采用百度AI情感分析接口，同时运用Vue+Express+PostgreSQL进行管理分析系统的搭建，将网络评论数据、景点POI数据、道路交通数据等作为数据源，通过对广州市红色旅游景点的空间特征、可达性、游客情感倾向进行分析，规划广州市红色研学路线，研究广州市红色旅游景点的空间格局及保护开发方法。</p><h2 id="3-主要功能"><a href="#3-主要功能" class="headerlink" title="3.主要功能"></a>3.主要功能</h2><!-- ![系统功能](https://raw.githubusercontent.com/FallonXC/blogImg/main/C1385%E7%B3%BB%E7%BB%9F%E5%8A%9F%E8%83%BD.png) --><img src="https://raw.githubusercontent.com/FallonXC/blogImg/main/C1385%E7%B3%BB%E7%BB%9F%E5%8A%9F%E8%83%BD.png" alt="系统功能" width="700"><h2 id="4-特点"><a href="#4-特点" class="headerlink" title="4.特点"></a>4.特点</h2><ul><li><p><strong>多源数据的红色旅游分析</strong>：本系统以红色旅游景点为核心对象，利用网络评论、POI等多源数据挖掘分析景点的空间特征，呈现直观、清晰且信息丰富的多种分析结果可视化，为管理研究人员提供了实践性的决策建议，有助于更好地管理保护、开发红色旅游资源。</p></li><li><p><strong>多维度情感分析与数据展示</strong>： 利用基于深度学习的百度AI情感分析技术结合游客的网络评论数据，能够更精准地捕捉游客对红色旅游景点的情感和感知意向，为管理人员提供更准确的用户反馈，从而优化景点服务和体验。</p></li><li><p><strong>定制化研学路线设计</strong>： 在结合已有红色景点分析功能的基础上，系统设计了具有区域特色、多层次、多方面的红色研学路线。这种设计支持研究人员自主规划和设计研学路线，使游客能够更全面地了解广州市的红色历史文化。</p></li><li><p><strong>小程序端的增强互动性</strong>： 通过小程序端，游客可以更方便地定位打卡，展示已打卡景点，增加游客与景点的互动性，使旅行更加有趣。</p></li><li><p><strong>综合性的旅游辅助平台</strong>： 本系统不仅提供景点信息和路线规划，还结合情感分析、互动打卡等功能，创造了一个全面的旅游辅助平台，增强了游客的旅行体验。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> esri </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>three.js gltf 模型转换为three.points点云模型</title>
      
      <link href="/2023/09/28/three.js%20gltf%E6%A8%A1%E5%9E%8B%E8%BD%AC%E6%8D%A2%E4%B8%BApoints/"/>
      <url>/2023/09/28/three.js%20gltf%E6%A8%A1%E5%9E%8B%E8%BD%AC%E6%8D%A2%E4%B8%BApoints/</url>
      
        <content type="html"><![CDATA[<p>three.js Gltf模型转换为three.points点云模型</p><h2 id="背景需求"><a href="#背景需求" class="headerlink" title="背景需求"></a>背景需求</h2><ol><li>对gltf格式的点云模型进行测距，调用three.js提供的raycaster射线无法穿透选中；</li><li>通过官网示例发现有相应实现点云点捕捉的代码，其格式为three.Points，因而存在需求将gltf点云模型转换成three.points模型；</li></ol><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> GLTFLoader <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/loaders/GLTFLoader"</span><span class="token punctuation">;</span><span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GLTFLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>gltfurl<span class="token punctuation">,</span>     <span class="token punctuation">(</span>gltf<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> mesh <span class="token operator">=</span> gltf<span class="token punctuation">.</span>scene<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 获取几何体和材质</span>        <span class="token keyword">const</span> geometry <span class="token operator">=</span> gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>geometry<span class="token punctuation">;</span>        <span class="token keyword">const</span> material <span class="token operator">=</span> gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>material<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 创建three.points对象</span>        <span class="token keyword">const</span> particles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Points</span><span class="token punctuation">(</span>geometry<span class="token punctuation">,</span> material<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 设置中心点，方便点云数据切片多次加载，看需要添加</span>        particles<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>        particles<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>        particles<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> z<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>particles<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 将模型引入three</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    undefined<span class="token punctuation">,</span>    <span class="token keyword">function</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> three.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 功能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>three.js 测距功能实现</title>
      
      <link href="/2023/09/27/three.js%20%E6%B5%8B%E8%B7%9D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/"/>
      <url>/2023/09/27/three.js%20%E6%B5%8B%E8%B7%9D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>three.js 测距功能实现</p><h1 id="three-js-测距功能实现"><a href="#three-js-测距功能实现" class="headerlink" title="three.js 测距功能实现"></a>three.js 测距功能实现</h1><h2 id="背景需求"><a href="#背景需求" class="headerlink" title="背景需求"></a>背景需求</h2><ol><li>对三维模型进行测距；</li><li>共两个按钮：测距、清空；</li></ol><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><ol><li><p>html设置</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">999</span><span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">80</span>px</span><span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>measureDis<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>测距<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span> <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">999</span><span class="token punctuation">;</span> <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">5</span>px</span><span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearDraw()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>清除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>data设置</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>      raycaster<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Raycaster</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      mouse<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      group<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Group</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      labelRenderer<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">CSS2DRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      groups<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      points<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      line<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>      measuring<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>init初始化函数</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//普通2D标签</span>    <span class="token keyword">let</span> contain <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 获取three.js的显示框id</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>contain<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">,</span> contain<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 设置three.js的显示框大小</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">"absolute"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 设置three.js的显示框位置</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">"8%"</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>right <span class="token operator">=</span> <span class="token string">"1%"</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>pointerEvents <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 避免HTML标签遮挡三维场景的鼠标事件</span>    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 将labelRenderer添加到文档主体</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>render标签渲染</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>mounted设置</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onWindowResize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 监测click</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>measuring<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onclick</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>methods设置</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 窗口大小改变时更新的渲染器和相机，保持渲染画面的正确</span><span class="token function">onWindowResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> newWidth <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span>    <span class="token keyword">const</span> newHeight <span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span>aspect <span class="token operator">=</span> newWidth <span class="token operator">/</span> newHeight<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>newWidth<span class="token punctuation">,</span> newHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">// click捕捉函数</span><span class="token function">onclick</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 获取鼠标点击的坐标</span>    <span class="token keyword">const</span> mouseX <span class="token operator">=</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">;</span>    <span class="token keyword">const</span> mouseY <span class="token operator">=</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 获取three.js场景的容器</span>    <span class="token keyword">let</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 将鼠标坐标转换为Three.js坐标系中的位置</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>mouseX <span class="token operator">-</span> container<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">/</span> container<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">)</span> <span class="token operator">*</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>mouse<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mouseY <span class="token operator">-</span> container<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token operator">/</span> container<span class="token punctuation">.</span>offsetHeight<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 设置穿透的射线</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>raycaster<span class="token punctuation">.</span>params<span class="token punctuation">.</span>Points<span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>raycaster<span class="token punctuation">.</span><span class="token function">setFromCamera</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mouse<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 获取射线和场景中对象的交点</span>    <span class="token keyword">const</span> intersects <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>raycaster<span class="token punctuation">.</span><span class="token function">intersectObjects</span><span class="token punctuation">(</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">,</span>        <span class="token boolean">false</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 如果存在多个交点数则取第一个</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>intersects<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> point <span class="token operator">=</span> intersects<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>point<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addPoint</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>x<span class="token punctuation">,</span> point<span class="token punctuation">.</span>y<span class="token punctuation">,</span> point<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">addPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 创建点对象</span>    <span class="token keyword">const</span> point <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 一个为场景对象</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>groups<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 将点的坐标保存到数组中</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 更新测量线</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">updateMeasurementLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">updateMeasurementLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 创建线的几何体和材质</span>        <span class="token keyword">const</span> lineGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>BufferGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFromPoints</span><span class="token punctuation">(</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>points        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> lineMaterial <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>LineBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>            color<span class="token punctuation">:</span> <span class="token number">0xf9f8ed</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 创建线对象</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>line<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Line</span><span class="token punctuation">(</span>lineGeometry<span class="token punctuation">,</span> lineMaterial<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>groups<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//   this.line.geometry.dispose();</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>line<span class="token punctuation">.</span>geometry <span class="token operator">=</span> lineGeometry<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 计算距离并显示在界面上</span>        <span class="token keyword">const</span> distance <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">distanceTo</span><span class="token punctuation">(</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`距离: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>distance<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 添加CSS 2DObject标签</span>        <span class="token comment" spellcheck="true">// 求中点坐标</span>        <span class="token keyword">let</span> centerX <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> centerY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> centerZ <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>points<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>z<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//创建标签</span>        <span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> earthDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        earthDiv<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">"label_name"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 定义的类名可以通过下面的style进行设置样式</span>        earthDiv<span class="token punctuation">.</span>textContent <span class="token operator">=</span> distance<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" m"</span><span class="token punctuation">;</span>        earthDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>marginTop <span class="token operator">=</span> <span class="token string">"-1em"</span><span class="token punctuation">;</span>        <span class="token keyword">const</span> label2D <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CSS2DObject</span><span class="token punctuation">(</span>earthDiv<span class="token punctuation">)</span><span class="token punctuation">;</span>        label2D<span class="token punctuation">.</span>name <span class="token operator">=</span> distance<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        label2D<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>centerX<span class="token punctuation">,</span> centerY<span class="token punctuation">,</span> centerZ<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//标签标注在obj世界坐标</span>        container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>label2D<span class="token punctuation">.</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>label2D<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//标签插入场景</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>groups<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>label2D<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// this.labelRenderer.scene.add(label2D);</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>labelRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>camera<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">measureDis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>measuring <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>measuring<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">clearDraw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>scene<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 移除this.groups中保存的所有对象</span>    <span class="token comment" spellcheck="true">// 注：不直接使用this.scene.children进行遍历，是因为遍历结果不全面无法得到页面所有Mesh有待商催</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>groups<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"Mesh"</span> <span class="token operator">||</span> object<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"Line"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 释放几何体和样式资源</span>            object<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            object<span class="token punctuation">.</span>material<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>group<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>object<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">"Line"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">this</span><span class="token punctuation">.</span>line <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// let label = this.scene.getObjectByName(object.name);</span>            object<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>measuring <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>measuring<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">createPoint</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">,</span> config <span class="token operator">=</span> <span class="token punctuation">{</span> color<span class="token punctuation">:</span> <span class="token number">0xf9f8ed</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token number">0.8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> mat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>MeshBasicMaterial</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        color<span class="token punctuation">:</span> config<span class="token punctuation">.</span>color <span class="token operator">||</span> <span class="token number">0xf9f8ed</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> sphereGeometry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>SphereGeometry</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>size <span class="token operator">||</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> sphere <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Mesh</span><span class="token punctuation">(</span>sphereGeometry<span class="token punctuation">,</span> mat<span class="token punctuation">)</span><span class="token punctuation">;</span>    sphere<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> sphere<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>style设置</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.label_name</span> </span><span class="token punctuation">{</span>    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#f9f8ed</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">16</span>px<span class="token punctuation">;</span>    <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">9999</span> <span class="token important">!important</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li></li></ol>]]></content>
      
      
      <categories>
          
          <category> three.js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 功能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>项目1</title>
      
      <link href="/2023/09/27/projects/project1/"/>
      <url>/2023/09/27/projects/project1/</url>
      
        <content type="html"><![CDATA[<p>three.js 测距功能实现</p>]]></content>
      
      
      <categories>
          
          <category> esri </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>Cesium 功能实现</title>
      
      <link href="/2023/09/15/Cesium%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/09/15/Cesium%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>Cesium 基础功能实现：初始化、加载影像</p><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><pre class="line-numbers language-javascript"><code class="language-javascript">Cesium<span class="token punctuation">.</span>Context<span class="token punctuation">.</span>memoryThreshold <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//设置GPU内存阈值为8MB,当GPU内存使用超过这个阈值时，Cesium将开始执行一些优化策略，以降低内存使用并提高性能。</span><span class="token comment" spellcheck="true">//地图将被嵌入到具有ID为machineMap的DOM元素中</span>window<span class="token punctuation">.</span>machineMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Viewer</span><span class="token punctuation">(</span><span class="token string">"machineMap"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  shadows<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//确定阴影是否由太阳投射形成。</span>  sceneModePicker<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取场景模式拾取器(SceneModePicker)对象。</span>  infoBox<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取信息框(InfoBox)对象。</span>  shouldAnimate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  skyAtmosphere<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//环绕地球边缘的蓝天和光晕效果，设置为false可将其关闭。</span>  selectionIndicator<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取选择指示符(SelectionIndicator)对象。</span>  navigation<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取导航帮助按钮(NavigationHelpButton)对象。</span>  skyBox<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>SkyBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//用于渲染星辰的天空盒，未定义时，使用默认星辰效果。</span>    sources<span class="token punctuation">:</span> <span class="token punctuation">{</span>      positiveX<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/rightav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeX<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/leftav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      positiveY<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/frontav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeY<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/backav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      positiveZ<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/topav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeZ<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/bottomav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> scene <span class="token operator">=</span> window<span class="token punctuation">.</span>machineMap<span class="token punctuation">.</span>scene<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//获取场景(scene)对象，包含了地图中的三维场景元素和功能</span><span class="token keyword">let</span> widget <span class="token operator">=</span> window<span class="token punctuation">.</span>machineMap<span class="token punctuation">.</span>cesiumWidget<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//获取CesiumWidget对象，用于渲染地图的核心部分</span><span class="token keyword">let</span> credit <span class="token operator">=</span> window<span class="token punctuation">.</span>machineMap<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>frameState<span class="token punctuation">.</span>creditDisplay<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//用于显示地图上的信用标识的对象</span>credit<span class="token punctuation">.</span>container<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>credit<span class="token punctuation">.</span>_imageContainer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//从信用标识容器中移除了图像容器，通常是地图底部显示的Cesium图标和文本，即去掉cesium水印</span><span class="token keyword">try</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"开启无人机地图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 设置相机位置，定位至模型</span>  scene<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 将经度、纬度、高度的坐标转换为笛卡尔坐标</span>    destination<span class="token punctuation">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">116.773446</span><span class="token punctuation">,</span> <span class="token number">23.471069</span><span class="token punctuation">,</span> <span class="token number">4632</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    orientation<span class="token punctuation">:</span> <span class="token punctuation">{</span>      heading<span class="token punctuation">:</span> <span class="token number">0.29510551037694466</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 相机的方向，单位是弧度，默认朝北</span>      pitch<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.677166982317591</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// 相机的俯仰角度，单位是弧度，默认是朝下</span>      roll<span class="token punctuation">:</span> <span class="token number">6.283185307179586</span><span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// 相机的滚动角度，单位是弧度，默认是0</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>widget<span class="token punctuation">.</span>_showRenderLoopErrors<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> title <span class="token operator">=</span> <span class="token string">"渲染时发生错误，已停止渲染。"</span><span class="token punctuation">;</span>    widget<span class="token punctuation">.</span><span class="token function">showErrorPanel</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> undefined<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Viewer设置"><a href="#Viewer设置" class="headerlink" title="Viewer设置"></a>Viewer设置</h2><pre class="line-numbers language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span>machineMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>Viewer</span><span class="token punctuation">(</span><span class="token string">"machineMap"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  shadows<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//确定阴影是否由太阳投射形成。</span>  sceneModePicker<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取场景模式拾取器(SceneModePicker)对象。</span>  infoBox<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取信息框(InfoBox)对象。</span>  shouldAnimate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  skyAtmosphere<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//环绕地球边缘的蓝天和光晕效果，设置为false可将其关闭。</span>  selectionIndicator<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取选择指示符(SelectionIndicator)对象。</span>  navigation<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//获取导航帮助按钮(NavigationHelpButton)对象。</span>  skyBox<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>SkyBox</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//用于渲染星辰的天空盒，未定义时，使用默认星辰效果。</span>    sources<span class="token punctuation">:</span> <span class="token punctuation">{</span>      positiveX<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/rightav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeX<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/leftav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      positiveY<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/frontav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeY<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/backav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      positiveZ<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/topav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      negativeZ<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@/assets/img/lt/bottomav9.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="相机设置"><a href="#相机设置" class="headerlink" title="相机设置"></a>相机设置</h2><pre class="line-numbers language-javascript"><code class="language-javascript">scene<span class="token punctuation">.</span>camera<span class="token punctuation">.</span><span class="token function">setView</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// 将经度、纬度、高度的坐标转换为笛卡尔坐标</span>  destination<span class="token punctuation">:</span> Cesium<span class="token punctuation">.</span>Cartesian3<span class="token punctuation">.</span><span class="token function">fromDegrees</span><span class="token punctuation">(</span><span class="token number">116.773446</span><span class="token punctuation">,</span> <span class="token number">23.471069</span><span class="token punctuation">,</span> <span class="token number">4632</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  orientation<span class="token punctuation">:</span> <span class="token punctuation">{</span>    heading<span class="token punctuation">:</span> <span class="token number">0.29510551037694466</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 相机的方向，单位是弧度，默认朝北</span>    pitch<span class="token punctuation">:</span> <span class="token operator">-</span><span class="token number">0.677166982317591</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// 相机的俯仰角度，单位是弧度，默认是朝下</span>    roll<span class="token punctuation">:</span> <span class="token number">6.283185307179586</span><span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// 相机的滚动角度，单位是弧度，默认是0</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="加载影像"><a href="#加载影像" class="headerlink" title="加载影像"></a>加载影像</h2><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">loadTDT</span><span class="token punctuation">(</span>viewer<span class="token punctuation">,</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> tdtUrl <span class="token operator">=</span> <span class="token string">"https://t{s}.tianditu.gov.cn/"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 天地图</span>  <span class="token keyword">let</span> subdomains <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">,</span> <span class="token string">"6"</span><span class="token punctuation">,</span> <span class="token string">"7"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 如果node.mapid不为null，则从viewer的imageryLayers中移除该ID对应的图层。</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>mapid <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> viewer<span class="token punctuation">.</span>imageryLayers<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>mapid<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 向viewer的imageryLayers添加一个新的影像提供者，并将其ID赋值给node.mapid</span>  node<span class="token punctuation">.</span>mapid <span class="token operator">=</span> viewer<span class="token punctuation">.</span>imageryLayers<span class="token punctuation">.</span><span class="token function">addImageryProvider</span><span class="token punctuation">(</span>    <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>UrlTemplateImageryProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      url<span class="token punctuation">:</span> tdtUrl <span class="token operator">+</span>        <span class="token string">"DataServer?T="</span> <span class="token operator">+</span>        node<span class="token punctuation">.</span>mapStyle <span class="token operator">+</span>        <span class="token string">"&amp;x={x}&amp;y={y}&amp;l={z}&amp;tk="</span> <span class="token operator">+</span>        node<span class="token punctuation">.</span>token<span class="token punctuation">,</span>      subdomains<span class="token punctuation">:</span> subdomains<span class="token punctuation">,</span>      tilingScheme<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>WebMercatorTilingScheme</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      maximumLevel<span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// URL模板中的{s}会被替换为subdomains数组中的一个元素，也就是一个子域名。这意味着，每次请求影像数据时，都会从这八个子域名中选择一个来用。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">loadTIN</span><span class="token punctuation">(</span>viewer<span class="token punctuation">,</span> node<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> terrainProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cesium<span class="token punctuation">.</span>CesiumTerrainProvider</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    url<span class="token punctuation">:</span> data_url<span class="token punctuation">,</span>    isSct<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 表示使用SCT（Scaled and Offset Terrain）地形数据格式</span>    requestVertexNormals<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 表示是否请求顶点法线信息</span>    requestWaterMask<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 表示是否请求水面遮罩信息</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  viewer<span class="token punctuation">.</span>terrainProvider <span class="token operator">=</span> terrainProvider<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> Cesium </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 示例 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>vue导出excel、txt、csv文件</title>
      
      <link href="/2023/09/13/vue%E5%AF%BC%E5%87%BAexcel%E3%80%81txt%E3%80%81csv%E6%96%87%E4%BB%B6/"/>
      <url>/2023/09/13/vue%E5%AF%BC%E5%87%BAexcel%E3%80%81txt%E3%80%81csv%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>基于xlsx、file-saver库导出excel、txt、csv文件</p><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><ul><li>需求：提供网页excel、txt、csv下载功能；</li></ul><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><ul><li>xlsx</li></ul><pre class="line-numbers language-vue"><code class="language-vue">npm install -g xlsx@0.16.0 --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-vue"><code class="language-vue">import * as XLSX from "xlsx";<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-vue"><code class="language-vue">createExcel(name, data) {  // 获取当前日期时间  const now = new Date();  // 构建文件名  const year = now.getFullYear();  const month = (now.getMonth() + 1).toString().padStart(2, "0");  const day = now.getDate().toString().padStart(2, "0");  const fileName = `job_${name}${year}${month}${day}.xlsx`;  console.log(fileName); // 输出类似于 "20230828.xlsx"  // 创建工作簿和工作表  // 数据为json格式  const ws = XLSX.utils.json_to_sheet(data);  const wb = XLSX.utils.book_new();  XLSX.utils.book_append_sheet(wb, ws, "Sheet1"); // Sheet1 是工作表的名称  // 将工作簿写入文件  XLSX.writeFile(wb, fileName); // 文件名为 example.xlsx}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>txt</li></ul><pre class="line-numbers language-vue"><code class="language-vue">npm install --save file-saver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-vue"><code class="language-vue">import { saveAs } from "file-saver";<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-vue"><code class="language-vue">createTXT(name, data) {  // 获取当前日期时间  const now = new Date();  // 构建文件名  const year = now.getFullYear();  const month = (now.getMonth() + 1).toString().padStart(2, "0");  const day = now.getDate().toString().padStart(2, "0");  const fileName = `job_${name}${year}${month}${day}.txt`;    // data为需要输入的字符串，注意需要添加[]  const file = new File([data], fileName, {    type: "text/plain;charset=utf-8",  });  saveAs(file);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>csv：与txt方法相同</li></ul><pre class="line-numbers language-vue"><code class="language-vue">createCSV(name, data) {  // 获取当前日期时间  const now = new Date();  // 构建文件名  const year = now.getFullYear();  const month = (now.getMonth() + 1).toString().padStart(2, "0");  const day = now.getDate().toString().padStart(2, "0");  const fileName = `job_${name}${year}${month}${day}.csv`;  // 步骤 2: 将数据转换为 CSV 字符串  data = data.map((row) => row.join(",")).join("\n");  const file = new File([data], fileName, {    type: "text/csv",  });  saveAs(file);}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 功能 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>